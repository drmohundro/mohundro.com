
title: "The new version of Rhino.Mocks is awesome!"
author: David
date: 2007/10/25

<p>Ayende is the man. Seriously.</p> <p>Today, he <a href="http://ayende.com/Blog/archive/2007/10/26/Rhino-Mocks-3.3.aspx">released Rhino Mocks 3.3 to great fanfare</a>.</p> <p>If there wasn't great fanfare, there should be. My favorite new feature - mocking objects that inherit from MarshalByRefObject. You might be asking yourself, why does this matter? Doesn't that only apply to remoting? Well, yes, sort of. The thing is, a huge number of the built-in classes in the CLR support this remoting infrastructure. You know the ones I'm talking about -&nbsp;the built-in classes that are hard to mock and test.</p> <p>At least they didn't let you mock them out until today. Here's an example of something that might have been harder to test before today:</p> <div style="border-right: rgb(221,221,221) 1px dotted; padding-right: 4px; border-top: rgb(221,221,221) 1px dotted; padding-left: 4px; font-size: small; background: rgb(60,60,60); padding-bottom: 4px; margin: 4px; border-left: rgb(221,221,221) 1px dotted; color: rgb(255,255,255); padding-top: 4px; border-bottom: rgb(221,221,221) 1px dotted; font-family: consolas,'Courier New',courier,monospace">[<span style="color: yellow">TestFixture</span>]<br><span style="color: #ff8000">public</span> <span style="color: #ff8000">class</span> <span style="color: yellow">Tests</span><br>{<br>&nbsp;&nbsp;&nbsp; [<span style="color: yellow">Test</span>]<br>&nbsp;&nbsp;&nbsp; <span style="color: #ff8000">public</span> <span style="color: #ff8000">void</span> TestingCoolRhinoMocksStuff()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: yellow">MockRepository</span> mocks = <span style="color: #ff8000">new</span> <span style="color: yellow">MockRepository</span>();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: yellow">Process</span> p = mocks.CreateMock&lt;<span style="color: yellow">Process</span>&gt;();<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #ff8000">using</span> (mocks.Record())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: yellow">Expect</span>.Call(p.Responding).Return(<span style="color: #ff8000">false</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #ff8000">using</span> (mocks.Playback())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: yellow">Assert</span>.IsFalse(p.Responding);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>}<br></div> <p>Yeah, I'm mocking System.Diagnostics.Process. Sweet.</p> <p>Take a look in Reflector and you'll find out just how many objects actually inherit from MarshalByRefObject. I think you'll be quite surprised.</p> <p>Thanks Ayende!</p>
