
title: "Powershell script to print diff output in color"
author: David
date: 2008/04/23

<p>Here is a simple script I wrote which was inspired by <a href="http://www.pixelbeat.org/docs/terminal_colours/">this post on terminal color highlighting</a> and by <a href="http://colordiff.sourceforge.net/">ColorDiff</a> that does essentially the same thing.</p><pre># Out-ColorDiff.ps1<br>Process {<br>&nbsp;&nbsp;&nbsp; if ($_) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach ($line in $_) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($line -match '^[&lt;|-]') {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write-Host -ForegroundColor red $line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif ($line -match '^[&gt;|+]') {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write-Host -ForegroundColor green $line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write-Host $line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>} 
</pre>
<p>Here is a screenshot of sample output from the script:</p>
<p><a href="http://www.mohundro.com/blog/content/binary/WindowsLiveWriter/Powershellscripttoprintdiffoutputincolor_99AD/image_2.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="274" alt="image" src="http://www.mohundro.com/blog/content/binary/WindowsLiveWriter/Powershellscripttoprintdiffoutputincolor_99AD/image_thumb.png" width="512" border="0"></a> </p>
<p>You can use it by piping the diff output to the script, like '<span style="font-family: monospace">svn diff somefile | out-colordiff</span>' or if you're stuck using something like MKS, you can use '<span style="font-family: monospace">si diff somefile | out-colordiff</span>'. 
<p>Possible (and easy) additions would be to add direct parsing of a file instead of taking an argument off of the pipeline. This is all I need currently, but if you wish to add more features, feel free to leave them in the comments. 

