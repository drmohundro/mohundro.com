
title: "Reflection by example with Powershell"
author: David
date: 2008/05/06

A coworker swung by a few days ago to ask some questions about using Reflection. I learn really well by example so I decided to use Powershell to show using Reflection. Below is the session I used and later emailed to him. You can see a few spots at the bottom of the example where I was unsure of the syntax on passing an empty parameter array, but I figured it out.  
This is a good example of why I like Powershell :-) <div style="font-size: 12pt; color: #d0d0d0; font-family: monospace; background-color: #202020">
<font color="#9a9fc7">  1 </font><span style="background-color: #202020"><font color="#f09479">[1]</font></span> » <span style="background-color: #202020"><font color="#87df71">"haha"</font></span>.gettype()<br><font color="#9a9fc7">  2 </font><br><font color="#9a9fc7">  3 </font>IsPublic IsSerial Name                                     BaseType<br><font color="#9a9fc7">  4 </font>-------- -------- ----                                     --------<br><font color="#9a9fc7">  5 </font>True     True     String                                   System.Object<br><font color="#9a9fc7">  6 </font><br><font color="#9a9fc7">  7 </font><br><font color="#9a9fc7">  8 </font><span style="background-color: #202020"><font color="#f09479">[2]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span> = <span style="background-color: #202020"><font color="#87df71">"haha"</font></span>.gettype()<br><font color="#9a9fc7">  9 </font><span style="background-color: #202020"><font color="#f09479">[3]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<br><font color="#9a9fc7"> 10 </font><br><font color="#9a9fc7"> 11 </font><br><font color="#9a9fc7"> 12 </font>MemberType    : Property<br><font color="#9a9fc7"> 13 </font>Name          : Chars<br><font color="#9a9fc7"> 14 </font>DeclaringType : System.String<br><font color="#9a9fc7"> 15 </font>ReflectedType : System.String<br><font color="#9a9fc7"> 16 </font>MetadataToken : <span style="background-color: #202020"><font color="#87df71">385875994</font></span><br><font color="#9a9fc7"> 17 </font>Module        : CommonLanguageRuntimeLibrary<br><font color="#9a9fc7"> 18 </font>PropertyType  : System.Char<br><font color="#9a9fc7"> 19 </font>Attributes    : None<br><font color="#9a9fc7"> 20 </font>CanRead       : True<br><font color="#9a9fc7"> 21 </font>CanWrite      : False<br><font color="#9a9fc7"> 22 </font>IsSpecialName : False<br><font color="#9a9fc7"> 23 </font><br><font color="#9a9fc7"> 24 </font>MemberType    : Property<br><font color="#9a9fc7"> 25 </font>Name          : Length<br><font color="#9a9fc7"> 26 </font>DeclaringType : System.String<br><font color="#9a9fc7"> 27 </font>ReflectedType : System.String<br><font color="#9a9fc7"> 28 </font>MetadataToken : <span style="background-color: #202020"><font color="#87df71">385875995</font></span><br><font color="#9a9fc7"> 29 </font>Module        : CommonLanguageRuntimeLibrary<br><font color="#9a9fc7"> 30 </font>PropertyType  : System.Int32<br><font color="#9a9fc7"> 31 </font>Attributes    : None<br><font color="#9a9fc7"> 32 </font>CanRead       : True<br><font color="#9a9fc7"> 33 </font>CanWrite      : False<br><font color="#9a9fc7"> 34 </font>IsSpecialName : False<br><font color="#9a9fc7"> 35 </font><br><font color="#9a9fc7"> 36 </font><br><font color="#9a9fc7"> 37 </font><br><font color="#9a9fc7"> 38 </font><span style="background-color: #202020"><font color="#f09479">[4]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[0]</font></span><br><font color="#9a9fc7"> 39 </font><br><font color="#9a9fc7"> 40 </font><br><font color="#9a9fc7"> 41 </font>MemberType    : Property<br><font color="#9a9fc7"> 42 </font>Name          : Chars<br><font color="#9a9fc7"> 43 </font>DeclaringType : System.String<br><font color="#9a9fc7"> 44 </font>ReflectedType : System.String<br><font color="#9a9fc7"> 45 </font>MetadataToken : <span style="background-color: #202020"><font color="#87df71">385875994</font></span><br><font color="#9a9fc7"> 46 </font>Module        : CommonLanguageRuntimeLibrary<br><font color="#9a9fc7"> 47 </font>PropertyType  : System.Char<br><font color="#9a9fc7"> 48 </font>Attributes    : None<br><font color="#9a9fc7"> 49 </font>CanRead       : True<br><font color="#9a9fc7"> 50 </font>CanWrite      : False<br><font color="#9a9fc7"> 51 </font>IsSpecialName : False<br><font color="#9a9fc7"> 52 </font><br><font color="#9a9fc7"> 53 </font><br><font color="#9a9fc7"> 54 </font><br><font color="#9a9fc7"> 55 </font><span style="background-color: #202020"><font color="#f09479">[5]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[0]</font></span>.name<br><font color="#9a9fc7"> 56 </font>Chars<br><font color="#9a9fc7"> 57 </font><span style="background-color: #202020"><font color="#f09479">[6]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.name<br><font color="#9a9fc7"> 58 </font>Length<br><font color="#9a9fc7"> 59 </font><span style="background-color: #202020"><font color="#f09479">[7]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod()<br><font color="#9a9fc7"> 60 </font><br><font color="#9a9fc7"> 61 </font><br><font color="#9a9fc7"> 62 </font>Name                       : get_Length<br><font color="#9a9fc7"> 63 </font>DeclaringType              : System.String<br><font color="#9a9fc7"> 64 </font>ReflectedType              : System.String<br><font color="#9a9fc7"> 65 </font>MemberType                 : Method<br><font color="#9a9fc7"> 66 </font>MetadataToken              : <span style="background-color: #202020"><font color="#87df71">100663629</font></span><br><font color="#9a9fc7"> 67 </font>Module                     : CommonLanguageRuntimeLibrary<br><font color="#9a9fc7"> 68 </font>MethodHandle               : System.RuntimeMethodHandle<br><font color="#9a9fc7"> 69 </font>Attributes                 : PrivateScope, Public, HideBySig, SpecialName<br><font color="#9a9fc7"> 70 </font>CallingConvention          : Standard, HasThis<br><font color="#9a9fc7"> 71 </font>ReturnType                 : System.Int32<br><font color="#9a9fc7"> 72 </font>ReturnTypeCustomAttributes : Int32<br><font color="#9a9fc7"> 73 </font>ReturnParameter            : Int32<br><font color="#9a9fc7"> 74 </font>IsGenericMethod            : False<br><font color="#9a9fc7"> 75 </font>IsGenericMethodDefinition  : False<br><font color="#9a9fc7"> 76 </font>ContainsGenericParameters  : False<br><font color="#9a9fc7"> 77 </font>IsPublic                   : True<br><font color="#9a9fc7"> 78 </font>IsPrivate                  : False<br><font color="#9a9fc7"> 79 </font>IsFamily                   : False<br><font color="#9a9fc7"> 80 </font>IsAssembly                 : False<br><font color="#9a9fc7"> 81 </font>IsFamilyAndAssembly        : False<br><font color="#9a9fc7"> 82 </font>IsFamilyOrAssembly         : False<br><font color="#9a9fc7"> 83 </font>IsStatic                   : False<br><font color="#9a9fc7"> 84 </font>IsFinal                    : False<br><font color="#9a9fc7"> 85 </font>IsVirtual                  : False<br><font color="#9a9fc7"> 86 </font>IsHideBySig                : True<br><font color="#9a9fc7"> 87 </font>IsAbstract                 : False<br><font color="#9a9fc7"> 88 </font>IsSpecialName              : True<br><font color="#9a9fc7"> 89 </font>IsConstructor              : False<br><font color="#9a9fc7"> 90 </font><br><font color="#9a9fc7"> 91 </font><br><font color="#9a9fc7"> 92 </font><br><font color="#9a9fc7"> 93 </font><span style="background-color: #202020"><font color="#f09479">[8]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke<br><font color="#9a9fc7"> 94 </font><br><font color="#9a9fc7"> 95 </font><br><font color="#9a9fc7"> 96 </font>MemberType          : Method<br><font color="#9a9fc7"> 97 </font>OverloadDefinitions : {System.Object Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo cu<br><font color="#9a9fc7"> 98 </font>                      lture), System.Object Invoke(Object obj, Object[] parameters)}<br><font color="#9a9fc7"> 99 </font>TypeNameOfValue     : System.Management.Automation.PSMethod<br><font color="#9a9fc7">100 </font>Value               : System.Object Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo cul<br><font color="#9a9fc7">101 </font>                      ture), System.Object Invoke(Object obj, Object[] parameters)<br><font color="#9a9fc7">102 </font>Name                : Invoke<br><font color="#9a9fc7">103 </font>IsInstance          : True<br><font color="#9a9fc7">104 </font><br><font color="#9a9fc7">105 </font><br><font color="#9a9fc7">106 </font><br><font color="#9a9fc7">107 </font><span style="background-color: #202020"><font color="#f09479">[9]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke(<span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>, [])<br><font color="#9a9fc7">108 </font>Unable to find type []: make sure that the assembly containing this type <span style="background-color: #202020"><font color="#7ec0ee">is</font></span> loaded.<br><font color="#9a9fc7">109 </font>At line:<span style="background-color: #202020"><font color="#87df71">1</font></span> char:<span style="background-color: #202020"><font color="#87df71">65</font></span><br><font color="#9a9fc7">110 </font>+ <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke(<span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>, []) &lt;&lt;&lt;&lt;<br><font color="#9a9fc7">111 </font><span style="background-color: #202020"><font color="#f09479">[10]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke(<span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>)<br><font color="#9a9fc7">112 </font>Cannot find an overload <span style="background-color: #202020"><font color="#7ec0ee">for</font></span> <span style="background-color: #202020"><font color="#87df71">"Invoke"</font></span> <span style="background-color: #202020"><font color="#7ec0ee">and</font></span> the argument count: <span style="background-color: #202020"><font color="#87df71">"1"</font></span>.<br><font color="#9a9fc7">113 </font>At line:<span style="background-color: #202020"><font color="#87df71">1</font></span> char:<span style="background-color: #202020"><font color="#87df71">47</font></span><br><font color="#9a9fc7">114 </font>+ <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke( &lt;&lt;&lt;&lt; <span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>)<br><font color="#9a9fc7">115 </font><span style="background-color: #202020"><font color="#f09479">[11]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke(<span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>, {})<br><font color="#9a9fc7">116 </font>Exception calling <span style="background-color: #202020"><font color="#87df71">"Invoke"</font></span> with <span style="background-color: #202020"><font color="#87df71">"2"</font></span> argument(s): <span style="background-color: #202020"><font color="#87df71">"Parameter count mismatch."</font></span><br><font color="#9a9fc7">117 </font>At line:<span style="background-color: #202020"><font color="#87df71">1</font></span> char:<span style="background-color: #202020"><font color="#87df71">47</font></span><br><font color="#9a9fc7">118 </font>+ <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke( &lt;&lt;&lt;&lt; <span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>, {})<br><font color="#9a9fc7">119 </font><span style="background-color: #202020"><font color="#f09479">[12]</font></span> » <span style="background-color: #202020"><font color="#7ee0ce">$temp</font></span>.GetProperties()<span style="background-color: #202020"><font color="#f09479">[1]</font></span>.GetGetMethod().Invoke(<span style="background-color: #202020"><font color="#87df71">"hello world"</font></span>, <span style="background-color: #202020"><font color="#7ee0ce">$Null</font></span>)<br><font color="#9a9fc7">120 </font><span style="background-color: #202020"><font color="#87df71">11</font></span><br><font color="#9a9fc7">121 </font><span style="background-color: #202020"><font color="#f09479">[13]</font></span> »<br><font color="#9a9fc7">122 </font>
</div> 
Note - I used the [:toHTML command from Vim](http://www.vim.org/htmldoc/syntax.html#:TOhtml) along with [Peter Provost](http://www.peterprovost.org/)'s [Powershell syntax file](http://www.vim.org/scripts/script.php?script_id=1327) to get the color. Powershell doesn't support color at the console like this yet without explicitly passing color arguments to Write-Host.
